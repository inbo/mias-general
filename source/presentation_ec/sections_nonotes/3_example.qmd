# Example Chinese muntjac


## Prioritising information needs {background-image="../../media/presentation_ec/symbol_1.png" background-size="5%" background-position="top 30px right 50px"}

::: {layout="[[60, 40]]"}


![Chinese muntjac](../../media/presentation_ec/muntjac3.png){height=400}

- small deer species native to China and Taiwan
- In Flanders at early invasion stage (Antwerp population)
- one of few known populations on EU mainland 
- subject to management (eradication) by ANB


:::



## Prioritising information needs {background-image="../../media/presentation_ec/symbol_1.png" background-size="5%" background-position="top 30px right 50px"} 


Monitoring scopes refined:

- Confirm population decline/eradication
  - Abundance under management - trend
  - Abundance under management - status
- Detection of (re-)introduced/left-over individuals
  - Presence under management - status
  - Presence after management - status


<!-- []{.fragment .semi-fade-out fragment-index=1} -->




## Developing sample design and data collection {background-image="../../media/presentation_ec/symbol_2.png" background-size="5%" background-position="top 30px right 50px"}

Sample frame & representative sample of locations

![](../../media/presentation_ec/plot_dist_sample.png){width=780 fig-align="center"}






## Developing sample design and data collection {background-image="../../media/presentation_ec/symbol_2.png" background-size="5%" background-position="top 30px right 50px"}


Optimal sample size for detection

- Aim detection: detect species with a [high probability]{style="text-decoration:underline"} if it is [present]{style="text-decoration:underline"}
  - high probability: e.g., 90 %
  - present: animals present at, e.g., 1 % of all possible locations
  - statistical test: Binomial test ($\alpha$ = 10 %)



## Developing sample design and data collection {background-image="../../media/presentation_ec/symbol_2.png" background-size="5%" background-position="top 30px right 50px"}


Optimal sample size for detection

```{r sample-size}
#| include: true
#| cache: true
#| message: false
#| results: 'hide'
#| fig-cap: " "
#| fig-align: center

#fig-cap: "Minimal detectable deviation as a function of sample size"

# minimal detectable deviation
get_mdd <- function(nl, power) {
  1 - ((1 - power)^(1/nl))
}
# number of locations
get_nl <- function(mdd, power) {
  (log(1 - power)/log(1 - mdd)) |> 
    ceiling()
}

# simulate curve
data_mdd <- data.frame(
  nl = seq(1,600),
  power = 0.9
) |>
  dplyr::mutate(
    mdd = purrr::map2_dbl(nl, power, \(x, y){
      get_mdd(nl = x, power = y) 
    })
) 

# points to highlight
data_mdd_hl <- data.frame(
    mdd = c(0.5, 0.1, 0.05, 0.01, 0.005),
    power = 0.9
  ) |> 
    dplyr::mutate(
      nl = purrr::map_int(mdd, \(x){get_nl(mdd = x, power = .9)}),
      label = sprintf("%.*f%% presence\n%.*f locations", 
                      ifelse(.data$mdd > 0.005, 0, 1), mdd*100, 0, nl),
      col = ifelse(mdd %in% c(0.01), TRUE, FALSE)
    ) 

# visualize minimal detectable deviation as a function of sample size
plot_mdd <- ggplot2::ggplot(data = data_mdd, ggplot2::aes(x = nl, y = mdd)) + 
  ggplot2::geom_line(linewidth = 1) + 
  ggplot2::geom_point(data = data_mdd_hl, size = 3) + 
  ggforce::geom_mark_circle(
    data = data_mdd_hl, 
    ggplot2::aes(
      x0 = nl + 50, y0 = mdd + 0.1, 
      label = label, group = nl, 
      fill = col
      ),
    #colour = "#C27900",
    #con.colour = "#C27900",
    con.type = "straight",
    label.fontface = "plain",
    label.fontsize = 12,
    label.buffer = grid::unit(20, "mm")
    ) +
  ggplot2::scale_y_continuous(labels = scales::percent) + 
  ggplot2::scale_fill_manual(values = c("transparent", "#C27900"), guide = "none") + 
  ggplot2::coord_cartesian(xlim = c(0, 500), ylim = c(0,0.25)) + 
  ggplot2::labs(
    x = "Number of sampling locations",
    y = "Minimal detectable presence (90 % detection probability)"
    ) + 
  ggplot2::theme_bw() + 
  ggplot2::theme(ggplot2::element_text(size = 16)) + 
  # costs
  ggplot2::scale_x_continuous(
    sec.axis = ggplot2::sec_axis(trans =~ .*(540), breaks = c(0,100,200,300,400,500)*(540), name = "Costs per year in EUR")
  ) 

plot_mdd + 
  ggplot2::theme(
    axis.title.x.top = ggplot2::element_text(color = "transparent", size = 13),
    axis.text.x.top =  ggplot2::element_text(color = "transparent", size = 11),
    axis.ticks.x.top = ggplot2::element_line(color = "transparent")
  )

```




## Developing sample design and data collection {background-image="../../media/presentation_ec/symbol_2.png" background-size="5%" background-position="top 30px right 50px"}

Costs (hypothetical)

```{r costs}
#| include: true
#| cache: true
#| message: false
#| results: 'hide'
#| fig-cap: " "
#| fig-align: center

plot_mdd + 
  ggplot2::theme(
    axis.title.x.top = ggplot2::element_text(color = "#2c8698", size = 13),
    axis.text.x.top =  ggplot2::element_text(color = "#2c8698", size = 11)
  )


```




